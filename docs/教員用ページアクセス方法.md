# 教員用ページアクセス方法

## 概要

教員用ページは生徒画面から隠されており、直接URLでのみアクセス可能です。

## アクセス方法

### 方法1: 直接URLでアクセス（推奨）

教員用ログインページのURL:
```
http://127.0.0.1:5014/teacher/login
```

または本番環境の場合:
```
https://your-domain.com/teacher/login
```

### 方法2: 隠しコマンドを使用（便利）

生徒用ページ（トップページなど）で、キーボードで **`RIKA`** と入力すると、自動的に教員ログインページに遷移します。

**使い方**:
1. 任意の生徒用ページを開く
2. キーボードで `R` `I` `K` `A` と順番に入力（大文字・小文字どちらでもOK）
3. 短い音が鳴り、教員ログインページに自動遷移

**注意**:
- 入力フィールド（テキストボックスなど）にフォーカスがある場合は動作しません
- 2秒以内に入力する必要があります
- 教員ページ内では動作しません（生徒用ページのみ）

### ブラウザのブックマーク登録推奨

1. 教員用ログインページを開く
2. ブラウザのブックマーク機能で登録
3. 名前: 「理科学習システム - 教員用」など
4. 次回からブックマークでアクセス

## 教員アカウント情報

### 管理者アカウント

| 項目 | 値 |
|-----|-----|
| 教員ID | `teacher` |
| パスワード | `science` |
| 権限 | 全クラス (1〜4組) の制御が可能 |

### 担任アカウント

| クラス | 教員ID | パスワード | 制御可能なクラス |
|-------|--------|----------|----------------|
| 1組 | `4100` | `science` | 1組のみ |
| 2組 | `4200` | `science` | 2組のみ |
| 3組 | `4300` | `science` | 3組のみ |
| 4組 | `4400` | `science` | 4組のみ |

### パスワードについて

- **全アカウント共通**: `science`
- セキュリティ上、本番運用時は個別のパスワードに変更することを推奨

## セキュリティ対策

### 1. URL直接アクセスのみ

- 生徒用トップページ (`/`) には教員用リンクを表示しない
- 生徒が偶然発見する可能性を低減
- URLを知っている教員のみがアクセス可能

### 2. 隠しコマンドによるアクセス

- 生徒用ページで `RIKA` と入力すると教員ページに遷移
- 入力フィールドにフォーカスがある場合は動作しない（誤作動防止）
- 教員が素早くアクセスできる便利な機能
- 生徒が偶然発見する可能性は極めて低い

### 3. ログイン認証

- URLを知っていても、正しい教員ID・パスワードがないとアクセス不可
- セッション管理により不正アクセスを防止

### 2. クラス別権限管理

- 担任は自分のクラスのみ制御可能
- 他クラスの設定変更は不可

### 4. 隠しコマンドの安全性

- 生徒が偶然 `RIKA` と入力する可能性は低い
- 入力フィールド内では動作しない（誤作動防止）
- たとえ発見されても、ログイン認証が必要

## 推奨される運用方法

### 初回セットアップ時

1. **管理者 (teacher) でログイン**
   - 方法A: ブラウザで `http://127.0.0.1:5014/teacher/login` を開く
   - 方法B: トップページで `RIKA` と入力
   ```
   ID: teacher
   パスワード: science
   ```

2. **各クラスのチャットボット設定を確認**
   - 初期状態は全クラス「有効」
   - 必要に応じて無効化

3. **各担任にアカウント情報を通知**
   ```
   【1組担任】
   アクセス方法:
   - URL: http://127.0.0.1:5014/teacher/login
   - または、生徒用ページで「RIKA」と入力
   
   ログイン情報:
   ID: 4100
   パスワード: science
   
   【2組担任】
   アクセス方法:
   - URL: http://127.0.0.1:5014/teacher/login
   - または、生徒用ページで「RIKA」と入力
   
   ログイン情報:
   ID: 4200
   パスワード: science
   
   （以下同様）
   ```

### 日常的な運用

#### 担任の先生の場合

1. ブックマークから教員用ログインページを開く（または `RIKA` と入力）
2. 自分のクラスのIDでログイン（例: `4100`）
3. ダッシュボードで自分のクラスのチャットボットを制御
4. 学習ログを確認

#### 管理者の場合

1. `teacher` でログイン（URLまたは `RIKA` コマンド）
2. 全クラスの設定を確認・調整
3. 全クラスの学習ログを確認
4. データエクスポートなどの管理業務

## トラブルシューティング

### Q: URLを忘れてしまった

**A**: このドキュメントを参照するか、以下を入力:
```
http://127.0.0.1:5014/teacher/login
```

### Q: ログインできない

**A**: 以下を確認:
1. 教員IDが正しいか（`teacher`, `4100`, `4200`, `4300`, `4400`）
2. パスワードが `science` か
3. 大文字・小文字の間違いがないか
4. 余分なスペースが入っていないか

### Q: 他のクラスを制御したい

**A**: 
- 担任アカウントは自分のクラスのみ制御可能（仕様）
- 全クラスを制御したい場合は管理者アカウント (`teacher`) を使用

### Q: 生徒に教員用ページを知られたくない

**A**: 以下の対策により十分に保護されています:
1. トップページにリンクなし
2. URLを知らなければアクセス不可
3. 隠しコマンド `RIKA` も偶然発見される可能性は低い
4. ログイン認証あり
5. 生徒番号でのログイン不可（教員IDのみ）

### Q: `RIKA` コマンドが動作しない

**A**: 以下を確認:
1. 入力フィールド（テキストボックス）にフォーカスがないか
2. 2秒以内に `R` `I` `K` `A` と入力しているか
3. 教員ページ内で試していないか（生徒用ページのみ動作）
4. ブラウザのJavaScriptが有効になっているか

### Q: 生徒が `RIKA` コマンドを発見したら？

**A**: 問題ありません:
1. コマンドを知っても、ログイン認証が必要
2. 教員ID・パスワードがなければアクセス不可
3. 生徒番号ではログインできない仕様

## よくある質問

### パスワードを変更したい

`app.py` の以下の部分を編集:

```python
TEACHER_CREDENTIALS = {
    "teacher": "science",  # ← ここを変更
    "4100": "science",     # ← ここを変更
    "4200": "science",
    "4300": "science",
    "4400": "science",
}
```

変更後、サーバーを再起動:
```bash
pkill -f "python app.py"
python app.py
```

### 新しい担任アカウントを追加したい

1. `TEACHER_CREDENTIALS` に追加
2. `TEACHER_CLASS_MAPPING` に対応を追加
3. サーバー再起動

### アクセスログを確認したい

現在は実装されていませんが、必要に応じて Flask のロギング機能を使用して記録可能です。

## セキュリティ強化のヒント

### レベル1: 基本（現在の実装）
- URL直接アクセスのみ
- ログイン認証
- クラス別権限

### レベル2: 中級（推奨）
- 個別パスワードの設定
- セッションタイムアウトの設定
- アクセスログの記録

### レベル3: 上級（本番運用時）
- HTTPS化
- 二要素認証
- IPアドレス制限
- パスワードのハッシュ化（データベース保存）

## まとめ

教員用ページは以下の方法でアクセス:

1. **URL**: `http://127.0.0.1:5014/teacher/login`
2. **ブックマーク登録推奨**
3. **生徒画面からはアクセス不可**

アカウント:
- 管理者: `teacher` / `science`
- 担任: `4100`, `4200`, `4300`, `4400` / `science`

---

**作成日**: 2025年10月17日  
**対象**: 教員・学校管理者  
**目的**: 教員用ページへの安全なアクセス方法の説明
